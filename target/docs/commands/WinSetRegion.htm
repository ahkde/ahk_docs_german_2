<!DOCTYPE HTML>
<html lang="de">
<head>
<title>WinSetRegion - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die WinSetRegion-Funktion ändert die Form eines bestimmten Fensters zu einem Rechteck, Polygon oder einer Ellipse." />
<meta name="ahk:equiv-v1" content="commands/WinSet.htm#Region" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>WinSetRegion</h1>

<p>Ändert die Form eines bestimmten Fensters zu einem Rechteck, Polygon oder einer Ellipse.</p>

<pre class="Syntax"><span class="func">WinSetRegion</span> <span class="optional">Optionen, FensterTitel, FensterText, IgnoriereTitel, IgnoriereText</span></pre>

<h2 id="Parameters">Parameter</h2>
<dl>
    <dt>Optionen</dt>
    <dd>
        <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
        <p>Wenn dieser Parameter weggelassen wird oder leer ist, wird der originale/normale Anzeigebereich des Fensters wiederhergestellt. Ansonsten können eine oder mehrere der folgenden Optionen angegeben werden, die mit Leerzeichen voneinander getrennt werden müssen:</p>
        <p><strong>Wn</strong>: Breite des Rechtecks oder der Ellipse. Zum Beispiel: <code>w200</code>.</p>
        <p><strong>Hn</strong>: Höhe des Rechtecks oder der Ellipse. Zum Beispiel: <code>h200</code>.</p>
        <p><strong>X-Y</strong>: Ein oder mehrere X-Y-Koordinatenpaare. Bei dem Beispiel <code>200-0</code> wäre 200 die X-Koordinate und 0 die Y-Koordinate.</p>
        <p><strong>E</strong>: Macht die Region zu einer Ellipse statt zu einem Rechteck. Diese Option ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.</p>
        <p><strong>R[w-h]</strong>: Macht die Region zu einem Rechteck mit abgerundeten Ecken. Bei dem Beispiel <code>R30-30</code> wäre jede Ecke eine 30x30 Ellipse. Lässt man <strong>w-h</strong> weg, wird standardmäßig 30-30 verwendet. <strong>R</strong> ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.</p>
        <p><strong>Rechteck oder Ellipse</strong>: Wenn die Optionen <strong>W</strong> und <strong>H</strong> vorhanden sind, wird der neue Anzeigebereich ein Rechteck sein, dessen linke obere Ecke das erste (und nur dieses) <strong>X-Y</strong>-Koordinatenpaar ist. Wenn dazu noch die <strong>E</strong>-Option vorhanden ist, wird der neue Anzeigebereich eine Ellipse statt ein Rechteck sein. Zum Beispiel: <code>WinSetRegion "50-0 W200 H250 E", <i>FensterTitel</i></code>.</p>
        <p><strong>Polygon</strong>: Wenn die Optionen <strong>W</strong> und <strong>H</strong> fehlen, wird der neue Anzeigebereich ein Polygon (Vieleck) sein, dessen Ecken mehrere <strong>X-Y</strong>-Koordinatenpaare sind (jedes Koordinatenpaar ist ein Punkt innerhalb des Fensters, relativ zu dessen oberen linken Ecke). Wenn zum Beispiel drei Koordinatenpaare angegeben sind, wird der neue Anzeigebereich in den meisten Fällen ein Dreieck sein. Die Reihenfolge der Koordinaten zueinander ist manchmal wichtig. Zusätzlich kann das Wort <strong>Wind</strong> in den <em>Optionen</em> angegeben werden, um die Kurvenmethode zur Bestimmung des Polygonbereichs zu verwenden.</p>
    </dd>
    <dt>FensterTitel</dt>
    <dd>
        <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a>, <a href="../Concepts.htm#numbers">Integer</a> oder <a href="../Objects.htm">Objekt</a></p>
        <p>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie unter <a href="../misc/WinTitle.htm">FensterTitel-Parameter</a>.</p>
    </dd>
    <dt>FensterText</dt>
    <dd>
        <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
        <p>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem internen Tool Window Spy aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</p>
    </dd>
    <dt>IgnoriereTitel</dt>
    <dd>
        <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
        <p>Alle Fenster, die diesen Wert in ihren Titeln enthalten, werden ignoriert.</p>
    </dd>
    <dt>IgnoriereText</dt>
    <dd>
        <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
        <p>Alle Fenster, die diesen Wert in ihren Textelementen enthalten, werden ignoriert.</p>
    </dd>
</dl>

<h2 id="Error_Handling">Fehlerbehandlung</h2>
<p>Es wird ein <a href="../objects/Error.htm#TargetError">TargetError</a> ausgelöst, wenn das Fenster nicht gefunden werden konnte.</p>
<p>Es wird ein <a href="../objects/Error.htm#ValueError">ValueError</a> ausgelöst, wenn eine oder mehrere <em>Optionen</em> ungültig sind, oder wenn mehr als 2000 Koordinatenpaare angegeben wurden.</p>
<p>Es wird ein <a href="../objects/Error.htm#OSError">OSError</a> ausgelöst, wenn die angegebene Region ungültig ist oder nicht auf das Zielfenster angewendet werden konnte.</p>

<h2 id="Remarks">Bemerkungen</h2>
<p>Die ID des Fensters, das sich unter dem Mauszeiger befindet, kann mit <a href="MouseGetPos.htm">MouseGetPos</a> abgerufen werden.</p>
<p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>
<p>Wenn eine Region für ein Fenster festgelegt wird, das dem Skript gehört, kann das System automatisch die Methode ändern, die es zum Rendern des Fensterrahmens verwendet, und dadurch das Aussehen des Fensters ändern. Der Effekt ähnelt dem unten gezeigten Workaround #2, der das Fenster aber erst beeinflusst, wenn seine Region zurückgesetzt ist.</p>
<p><strong>Bekannte Einschränkung</strong>: Eine Region für ein Fenster zu setzen, das nicht zum Skript gehört, kann zu unerwarteten Ergebnissen führen, wenn das Fenster eine Titelleiste hat und die Systemeinstellung "Desktopgestaltung" aktiviert ist. Das liegt daran, dass der sichtbare Rahmen nicht wirklich Teil des Fensters ist, sondern von einem separaten Systemprozess gerendert wird, der als "Desktop Window Manager" (kurz DWM; zu Deutsch Desktopfenster-Manager) bezeichnet wird. Beachten Sie, dass die Desktopgestaltung in Windows 8 und höher <a href="https://docs.microsoft.com/de-de/windows/compatibility/desktop-window-manager-is-always-on">immer aktiviert</a> ist. Sie können einen der beiden folgenden Workarounds verwenden:</p>
<pre><em>; #1: Titelleiste des Fensters entfernen.</em>
WinSetStyle "-0xC00000", "Fenstertitel"

<em>; Um es rückgängig zu machen:</em>
WinSetStyle "+0xC00000", "Fenstertitel"</pre>
<pre><em>; #2: DWM-Rendering des Fensterrahmens deaktivieren.</em>
DllCall("dwmapi\DwmSetWindowAttribute", "ptr", WinExist("Fenstertitel")
  , "uint", DWMWA_NCRENDERING_POLICY := 2, "int*", DWMNCRP_DISABLED := 1, "uint", 4)
  
<em>; Um es rückgängig zu machen (was auch dazu führen kann, dass jede gesetzte Region ignoriert wird):</em>
DllCall("dwmapi\DwmSetWindowAttribute", "ptr", WinExist("Fenstertitel")
  , "uint", DWMWA_NCRENDERING_POLICY := 2, "int*", DWMNCRP_ENABLED := 2, "uint", 4)
</pre>


<h2 id="Related">Siehe auch</h2>
<p><a href="Win.htm">Win-Funktionen</a>, <a href="Control.htm">Control-Funktionen</a></p>

<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Macht alle Bereiche des Texteditors außerhalb dieses Rechtecks unsichtbar. Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion "50-0 W200 H250", "ahk_class Notepad"</pre>
</div>

<div class="ex" id="ExRounded">
<p><a class="ex_number" href="#ExRounded"></a> Das gleiche wie oben, aber mit abgerundeten Ecken. Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion "50-0 W200 H250 R40-40", "ahk_class Notepad"</pre>
</div>

<div class="ex" id="ExEllipse">
<p><a class="ex_number" href="#ExEllipse"></a> Erstellt eine Ellipse anstelle eines Rechtecks. Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion "50-0 W200 H250 E", "ahk_class Notepad"</pre>
</div>

<div class="ex" id="ExTriangle">
<p><a class="ex_number" href="#ExTriangle"></a> Erstellt ein nach unten gerichtetes Dreieck. Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion "50-0 250-0 150-250", "ahk_class Notepad"</pre>
</div>

<div class="ex" id="ExRestore">
<p><a class="ex_number" href="#ExRestore"></a> Stellt den originalen/normalen Anzeigebereich des Fensters wieder her. Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion , "ahk_class Notepad"</pre>
</div>

<div class="ex" id="ExAdvanced">
<p><a class="ex_number" href="#ExAdvanced"></a> Erstellt ein durchsichtiges rechteckiges Loch innerhalb des Texteditors (oder eines anderen Fensters). Es sind zwei Rechtecke unten angegeben: ein Äußeres und ein Inneres. Jedes Rechteck besteht aus 5 X/Y-Koordinatenpaaren, weil das erste Koordinatenpaar am Ende wiederholt wird, um das Rechteck wieder zu "schließen". Eventuell funktioniert dieses Beispiel nicht so gut mit dem neuen Texteditor unter Windows 11 oder höher.</p>
<pre>WinSetRegion "0-0 300-0 300-300 0-300 0-0   100-100 200-100 200-200 100-200 100-100", "ahk_class Notepad"</pre>
</div>

</body>
</html>
