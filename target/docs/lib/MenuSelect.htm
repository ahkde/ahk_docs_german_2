<!DOCTYPE HTML>
<html lang="de">
<head>
<title>MenuSelect - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die MenuSelect-Funktion ruft einen Menüpunkt in der Menüleiste eines bestimmten Fensters auf." />
<meta name="ahk:equiv-v1" content="lib/WinMenuSelectItem.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>MenuSelect</h1>

<p>Ruft einen Menüpunkt in der Menüleiste eines bestimmten Fensters auf.</p>

<pre class="Syntax"><span class="func">MenuSelect</span> FensterTitel, FensterText, Menü <span class="optional">, Untermenü1, Untermenü2, Untermenü3, Untermenü4, Untermenü5, Untermenü6, IgnoriereTitel, IgnoriereText</span></pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>FensterTitel</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a>, <a href="../Concepts.htm#numbers">Integer</a> oder <a href="../Objects.htm">Objekt</a></p>
    <p>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie unter <a href="../misc/WinTitle.htm">FensterTitel-Parameter</a>.</p>
  </dd>

  <dt>FensterText</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem internen Tool Window Spy aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</p>
  </dd>

  <dt>Menü</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Der Name (oder ein Präfix des Namens) des auf oberster Ebene befindlichen Menüpunkts, z. B. Datei, Bearbeiten, Ansicht. Es kann auch die Position des gewünschten Menüpunkts sein - <code>1&amp;</code> wäre das erste Menü, <code>2&amp;</code> das zweite Menü, und so weiter.</p>
    <p>Die Suche erfolgt nicht-Groß-/Kleinschreibung-sensitiv, abhängig von den aktuellen Sprach- und Regionseinstellungen des Benutzers, und stoppt beim ersten gefundenen Menüpunkt. Das Und-Zeichen (&amp;), welches verwendet wird, um den unterstrichenen Buchstaben in einem Menüpunkt zu kennzeichnen, kann <em>meistens</em> weggelassen werden (das heißt, dass &amp;Datei das gleiche ist wie Datei).</p>
    <p class="warning"><strong>Bekannte Einschränkung:</strong> Wenn der Parameter ein Und-Zeichen enthält, muss er genau mit dem Menüpunktnamen übereinstimmen, inklusive aller nicht direkt geschriebenen Und-Zeichen (die versteckt oder als Unterstrich angezeigt werden). Wenn der Parameter kein Und-Zeichen enthält, werden alle Und-Zeichen (auch die direkt geschriebenen) ignoriert. Ein Menüpunkt, der zum Beispiel als "a &amp;&nbsp;b" dargestellt wird, stimmt mit den Parameterwerten <code>a &amp;&amp;&nbsp;b</code> oder <code>a &nbsp;b</code> überein.</p>
    <p>Geben Sie <code>0&amp;</code> an, um das <a href="#sys">Systemmenü</a> des Fensters zu nutzen.</p>
  </dd>

  <dt>Untermenü1</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Name oder Position des Menüpunkts, der ausgewählt werden soll (siehe oben).</p>
    <p>Dieser Parameter kann weggelassen werden, wenn der auf oberster Ebene befindliche Menüpunkt kein Menü enthält (selten).</p>
  </dd>

  <dt>Untermenü2</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Enthält <em>Untermenü1</em> selbst ein Menü, könnte man hier den Namen oder Position von einem seiner Menüpunkte angeben.</p>
  </dd>

  <dt>Untermenü3</dt>
  <dt>Untermenü4</dt>
  <dt>Untermenü5</dt>
  <dt>Untermenü6</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Wie oben.</p>
  </dd>

  <dt>IgnoriereTitel</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Alle Fenster, die diesen Wert in ihren Titeln enthalten, werden ignoriert.</p>
  </dd>

  <dt>IgnoriereText</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Alle Fenster, die diesen Wert in ihren Textelementen enthalten, werden ignoriert.</p>
  </dd>

</dl>

<h2 id="Error_Handling">Fehlerbehandlung</h2>
<p>Es wird ein <a href="Error.htm#TargetError">TargetError</a> ausgelöst, wenn das Fenster oder Steuerelement nicht gefunden werden konnte oder kein Standard-Win32-Menü hat.</p>
<p>Es wird ein <a href="Error.htm#ValueError">ValueError</a> ausgelöst, wenn ein Menü, Untermenü oder Menüpunkt nicht gefunden werden konnte oder wenn sich der letzte Menüparameter auf einen Menüpunkt bezieht, der ein Untermenü öffnet.</p>

<h2 id="Remarks">Bemerkungen</h2>
<p>Diese Funktion funktioniert auch, wenn das Zielfenster nicht aktiv ist. Allerdings ist es möglich, dass einige Fenster in einem <a href="WinRestore.htm">nicht-minimierten</a> Zustand sein müssen.</p>
<p>Diese Funktion <strong>wird nicht funktionieren</strong>, wenn Programme nicht-standardisierte Menüleisten verwenden. Microsoft Outlook und Outlook Express verwenden beispielsweise versteckte Werkzeugleisten für ihre Menüleisten. In solchen Fällen sind <a href="ControlSend.htm">ControlSend</a> oder <a href="PostMessage.htm">PostMessage</a> gut geeignet, weil sie in der Lage sein sollten, mit einigen dieser nicht-standardisierten Menüleisten interagieren zu können.</p>
<p>In den Menü-Parametern können auch Positionsnummern angegeben werden. Diese Methode existiert, um Menüs zu unterstützen, die keinen Text haben (weil sie beispielsweise Bilder statt Text enthalten). Position 1&amp; ist der erste Menüpunkt (z. B. das Datei-Menü), Position 2&amp; ist der zweite Menüpunkt (z. B. das Bearbeiten-Menü), und so weiter. Menü-Trennlinien zählen auch als Menüpunkte beim Bestimmen der Position.</p>
<p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>

<h2 id="sys">Systemmenü</h2>
<p><em>Menü</em> kann <code>0&amp;</code> sein, um einen Menüpunkt im Systemmenü des Fensters auszuwählen. Dieses Menü kann in der Regel aufgerufen werden, wenn man <kbd>Alt</kbd>+<kbd>Leer</kbd> drückt oder auf das Symbol in der Titelleiste des Fensters klickt. Zum Beispiel:</p>
<pre><em>; Fügen Sie einen Befehl in cmd.exe ein, ohne das Fenster zu aktivieren.</em>
A_Clipboard := "echo Hallo, Welt!`r"
MenuSelect "ahk_exe cmd.exe",, "0&amp;", "Bearbeiten", "Einfügen"</pre>
<p class="warning"><strong>Vorsicht:</strong> Wenden Sie diese Methode nur bei Fenstern an, die benutzerdefinierte Menüpunkte in ihrem Systemmenü haben.</p>
<p>Wenn das Fenster noch kein benutzerdefiniertes Systemmenü hat, wird eine Kopie des Standard-Systemmenüs erstellt und dem Zielfenster als Nebeneffekt zugeordnet. Diese Kopie wird vom System zerstört, wenn das Skript beendet wird, und führt dazu, dass andere Skripte nicht mehr darauf zugreifen können. Vermeiden Sie daher, 0&amp; in Verbindung mit Menüpunkten zu nutzen, die alle Fenster standardmäßig im Systemmenü haben. Versuchen Sie stattdessen, die <a href="https://msdn.microsoft.com/library/ms646360">WM_SYSCOMMAND</a>-Meldung direkt via PostMessage zu senden. Zum Beispiel:</p>
<pre><em>; Hat denselben Effekt wie [<a href="WinMinimize.htm">WinMinimize</a> "A"], plus der System-Sound beim Minimieren eines Fensters.</em>
WM_SYSCOMMAND := 0x0112
SC_MINIMIZE := 0xF020
PostMessage WM_SYSCOMMAND, SC_MINIMIZE, 0,, "A"</pre>

<h2 id="Related">Siehe auch</h2>
<p><a href="ControlSend.htm">ControlSend</a>, <a href="PostMessage.htm">PostMessage</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Wählt <code class="no-highlight">Datei -&gt; Öffnen</code> im Texteditor aus. Dieses Beispiel kann unter Windows 11 oder höher fehlschlagen, da es die klassische Version vom Texteditor erfordert.</p>
<pre>MenuSelect "Unbenannt - Editor",, "Datei", "Öffnen"</pre>
</div>

<div class="ex" id="ExPos">
<p><a class="ex_number" href="#ExPos"></a> Wie oben, außer dass die Auswahl über die Position anstelle des Namens erfolgt. In Windows 10 muss 2&amp; mit 3&amp; ersetzt werden, aufgrund des neuen Menüpunkts "Neues Fenster". Dieses Beispiel kann unter Windows 11 oder höher fehlschlagen, da es die klassische Version vom Texteditor erfordert.</p>
<pre>MenuSelect "Unbenannt - Editor",, "1&amp;", "2&amp;"</pre>
</div>

<div class="ex" id="ExMainWin">
<p><a class="ex_number" href="#ExMainWin"></a> Wählt <code class="no-highlight">View -&gt; Lines most recently executed</code> im <a href="../Program.htm#main-window">Hauptfenster</a> aus.</p>
<pre>WinShow "ahk_class AutoHotkey"
MenuSelect "ahk_class AutoHotkey",, "View", "Lines most recently executed"</pre>
</div>

</body>
</html>
