<!DOCTYPE HTML>
<html lang="de">
<head>
<title>OnCommand (GUI) - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die OnCommand-Methode eines GuiControl-Objekts registriert eine Funktion oder Methode, die aufgerufen wird, wenn eine Steuerelement­benachrichtigung via WM_COMMAND-Meldung empfangen wird." />
<meta name="ahk:equiv-v1" content="lib/GuiControl.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css">
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>OnCommand</h1>
<p>Registriert eine Funktion oder Methode, die aufgerufen wird, wenn eine Steuerelement­benachrichtigung via <a href="#WM_COMMAND">WM_COMMAND</a>-Meldung empfangen wird.</p>
<pre class="Syntax"><a href="GuiControl.htm">GuiCtrl</a>.<span class="func">OnCommand</span>(NachrichtCode, Rückruf <span class="optional">, HinzufügenEntfernen</span>)</pre>

<h2 id="Parameters">Parameter</h2>
<dl>
  <dt>NachrichtCode</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#numbers">Integer</a></p>
    <p>Ein steuerelementdefinierter Benachrichtigungscode, der überwacht werden soll.</p>
  </dd>
  
  <dt>Rückruf</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a> oder <a href="../misc/Functor.htm">Funktionsobjekt</a></p>
    <p>Eine Funktion, eine Methode oder ein Objekt, die/das aufgerufen wird, wenn das Ereignis ausgelöst wird.</p>
    <p>Wenn die GUI ein Event-Sink hat (d.h. wenn der <em>EreignisObj</em>-Parameter von <a href="Gui.htm#Call">Gui()</a> angegeben wurde), kann dieser Parameter der Name einer Methode im Event-Sink sein. Andernfalls muss dieser Parameter ein <a href="../misc/Functor.htm">Funktionsobjekt</a> sein.</p>
    <p id="Callback_Parameters">Die Rückruffunktion akzeptiert einen Parameter und kann wie folgt <a href="../Functions.htm#intro">definiert</a> werden:</p>
    <pre class="NoIndent">MeinRückruf(GuiCtrl) { ...</pre>
    <p>Es spielt keine Rolle, welchen Namen Sie dem Parameter geben, allerdings wird ihm als Wert das <a href="GuiControl.htm">GuiControl-Objekt</a> des aktuellen GUI-Steuerelements zugewiesen.</p>
    <p>Der Parameter der Rückruffunktion kann weggelassen werden, wenn die entsprechende Information nicht benötigt wird, aber dann muss ein Sternchen angegeben werden, z.B. <code>MeinRückruf(*)</code>.</p>
    <p>Die <a href="GuiOnEvent.htm#Callback_Parameters">OnEvent-Hinweise</a> bezüglich <code>this</code> und Bound-Funktionen gelten auch für OnCommand.</p>
    <p id="Callback_Return_Value">Wenn mehrere Rückruffunktionen für ein Ereignis registriert sind, kann eine Rückruffunktion einen nicht-leeren Wert zurückgeben, um zu verhindern, dass die restlichen Rückruffunktionen aufgerufen werden.</p>
    <p>Der Rückgabewert der Rückruffunktion wird vom GUI-Steuerelement ignoriert.</p>
  </dd>
  
  <dt>HinzufügenEntfernen</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#numbers">Integer</a></p>
    <p>Wenn weggelassen, wird standardmäßig 1 verwendet. Andernfalls geben Sie eine der folgenden Zahlen an:</p>
    <ul>
      <li>1 = Die Rückruffunktion nach anderen zuvor registrierten Rückruffunktionen aufrufen.</li>
      <li>-1 = Die Rückruffunktion vor anderen zuvor registrierten Rückruffunktionen aufrufen.</li>
      <li>0 = Die Rückruffunktion nicht aufrufen.</li>
    </ul>
  </dd>
</dl>

<h2 id="WM_COMMAND">WM_COMMAND</h2>
<p>Bestimmte Steuerelemente senden eine <a href="https://learn.microsoft.com/windows/win32/menurc/wm-command">WM_COMMAND</a>-Meldung, wann immer ein interessantes Ereignis eintritt. In der Regel sind das Windows-Steuerelemente, die es schon lange gibt, da neuere Steuerelemente die WM_NOTIFY-Meldung verwenden (siehe <a href="GuiOnNotify.htm">OnNotify</a>). Häufig verwendete Benachrichtigungscodes wurden in Ereignisse übersetzt, die ein Skript mit <a href="GuiOnEvent.htm">OnEvent</a> überwachen kann.</p>
<p>Die Parameter der Meldung enthalten die Steuerelement-ID, das Fensterhandle (HWND) und den Benachrichtigungscode, die AutoHotkey verwendet, um die Benachrichtigung an die entsprechende Rückruffunktion zu senden. Es gibt keine weiteren Parameter.</p>
<p>Welche Benachrichtigungen es genau gibt (falls vorhanden), entnehmen Sie bitte der Dokumentation des Steuerelements. <a href="https://learn.microsoft.com/windows/win32/controls/individual-control-info">Control Library (Microsoft Docs)</a> enthält Links zu jedem der gängigen Windows-Steuerelemente (allerdings verwenden nur wenige von ihnen WM_COMMAND). Die Benachrichtigungscodes (Nummern) können im Windows SDK oder durch Suchen im Internet gefunden werden.</p>

<h2 id="Related">Siehe auch</h2>
<p>Folgende <a href="GuiOnEvent.htm">OnEvent</a>-Hinweise gelten auch für OnCommand: <a href="GuiOnEvent.htm#Threads">Threads</a>, <a href="GuiOnEvent.htm#Destroying_the_GUI">GUI zerstören</a>.</p>
<p><a href="GuiOnNotify.htm">OnNotify</a> kann für Benachrichtigungen verwendet werden, die als WM_NOTIFY-Meldung gesendet wurden.</p>

</body>
</html>
