<!DOCTYPE HTML>
<html lang="de">
<head>
<title>WinGetText - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die WinGetText-Funktion ruft den Text eines bestimmten Fensters ab." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>WinGetText</h1>

<p>Ruft den Text eines bestimmten Fensters ab.</p>

<pre class="Syntax">Text := <span class="func">WinGetText</span>(<span class="optional">FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</span>)</pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a>, <a href="../Concepts.htm#numbers">Integer</a> oder <a href="../Objects.htm">Objekt</a></p>
    <p>Wenn jeder dieser Parameter leer ist oder weggelassen wird, wird das <a href="../misc/WinTitle.htm#LastFoundWindow">Zuletzt Gefundene Fenster</a> verwendet. Andernfalls geben Sie für <em>FensterTitel</em> einen <a href="../misc/WinTitle.htm">Fenstertitel oder andere Kriterien</a> zur Identifizierung des Zielfensters und/oder für <em>FensterText</em> eine Teilzeichenkette aus einem Textelement des Zielfensters an (Textelemente können mit dem internen Tool "Window Spy" in Erfahrung gebracht werden). Versteckte Textelemente werden erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet wurde. Fenster, deren Titel oder Texte <em>AusnahmeTitel</em> bzw. <em>AusnahmeText</em> enthalten, werden ignoriert.</p>
  </dd>

</dl>

<h2 id="Return_Value">Rückgabewert</h2>
<p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
<p>Diese Funktion gibt den Text des angegebenen Fensters zurück.</p>

<h2 id="Error_Handling">Fehlerbehandlung</h2>
<p>Es wird ein <a href="Error.htm#TargetError">TargetError</a> ausgelöst, wenn das Fenster nicht gefunden werden konnte.</p>
<p>Es wird ein <a href="Error.htm">Error</a> ausgelöst, wenn der Text des Fensters aufgrund eines Problems nicht ermittelt werden konnte.</p>

<h2 id="Remarks">Bemerkungen</h2>
<p>Der abgerufene Text ist grundsätzlich derselbe wie der, den das interne Tool "Window Spy" für dieses Fenster anzeigt. Wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> ausgeschaltet wurde, werden versteckte Texte im Rückgabewert weggelassen.</p>
<p>Jedes Textelement endet mit einem CR-LF-Paar (`r`n). Um Zeilen oder Teilzeichenketten einzeln zu extrahieren, verwenden Sie Funktionen wie <a href="InStr.htm">InStr</a> und <a href="SubStr.htm">SubStr</a>. Es kann auch eine <a href="LoopParse.htm">parsende Schleife</a> verwendet werden, um Zeilen oder Wörter einzeln durchzugehen.</p>
<p>Wenn der abgerufene Text gekürzt (unvollständig) ist, kann es erforderlich sein, den Text stattdessen durch Senden der WM_GETTEXT-Meldung via <a href="SendMessage.htm">SendMessage</a> abzurufen. Der Grund dafür ist, dass einige Anwendungen nicht richtig auf die WM_GETTEXTLENGTH-Meldung reagieren, wodurch AutoHotkey den Rückgabewert zu klein für den gesamten Text macht.</p>
<p>Diese Funktion kann sehr viel Arbeitsspeicher beanspruchen, wenn das Zielfenster eine große Menge an Text enthält (z.B. wenn ein großes Dokument in einem Texteditor geöffnet wurde). Um das zu verhindern, verwenden Sie stattdessen <a href="ControlGetText.htm">ControlGetText</a>, um nur bestimmte Bereiche des Fenstertextes abzurufen. In allen Fällen kann der Speicher einer Variable später wieder freigegeben werden, indem ihr ein leerer Wert zugewiesen wird, d.h. <code>Text := ""</code>.</p>
<p><code>SetTitleMatchMode "Slow"</code> muss nicht verwendet werden, da WinGetText den Text immer im langsamen Modus abruft (dieser Modus funktioniert mit viel mehr Steuerelementen).</p>
<p>Mit <a href="WinGetControls.htm">WinGetControls</a> kann eine Liste von Steuerelementen abgerufen werden, die in einem Fenster enthalten sind.</p>
<p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>

<h2 id="Related">Siehe auch</h2>
<p><a href="ControlGetText.htm">ControlGetText</a>, <a href="WinGetTitle.htm">WinGetTitle</a>, <a href="WinGetPos.htm">WinGetPos</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Öffnet den Taschenrechner, wartet bis er existiert, und ermittelt und meldet seinen Text.</p>
<pre>Run "calc.exe"
WinWait "Rechner"
MsgBox "Der Text ist:`n" WinGetText() <em>; Verwendet das von WinWait gefundene Fenster.</em></pre>
</div>

</body>
</html>
