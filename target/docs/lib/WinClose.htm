<!DOCTYPE HTML>
<html lang="de">
<head>
<title>WinClose - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die WinClose-Funktion schließt ein bestimmtes Fenster." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
</head>
<body>

<h1>WinClose</h1>

<p>Schließt ein bestimmtes Fenster.</p>

<pre class="Syntax"><span class="func">WinClose</span> <span class="optional">FensterTitel, FensterText, Wartezeit, AusnahmeTitel, AusnahmeText</span></pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>FensterTitel, FensterText, AusnahmeTitel, AusnahmeText</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a>, <a href="../Concepts.htm#numbers">Integer</a> oder <a href="../Objects.htm">Objekt</a></p>
    <p>Wenn jeder dieser Parameter ungesetzt ist oder weggelassen wird, wird das <a href="../misc/WinTitle.htm#LastFoundWindow">Zuletzt Gefundene Fenster</a> verwendet. Andernfalls geben Sie für <em>FensterTitel</em> ein <a href="../misc/WinTitle.htm">Fenstertitel oder andere Kriterien</a> zur Identifizierung des Zielfensters und/oder für <em>FensterText</em> eine Teilzeichenkette aus einem Textelement des Zielfensters an (Textelemente können mit dem internen Tool "Window Spy" aufgedeckt werden). Versteckte Textelemente werden erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet wurde. Fenster, deren Titel oder Texte <em>AusnahmeTitel</em> bzw. <em>AusnahmeText</em> enthalten, werden ignoriert.</p>
  </dd>

  <dt>Wartezeit</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#numbers">Integer</a> oder <a href="../Concepts.htm#numbers">Float</a></p>
    <p>Wenn dieser Parameter weggelassen wird oder leer ist, wird die Funktion überhaupt nicht warten. Wenn 0, gilt eine Wartezeit von 500&nbsp;ms. Jeder andere Wert wird als Sekunden interpretiert (auch mit Dezimalpunkt oder als <a href="../Variables.htm#Expressions">Ausdruck</a>) und definiert, wie lange auf das Schließen des Fensters gewartet werden soll. Schließt sich das Fenster innerhalb dieser Zeit nicht, wird das Skript fortgesetzt. Während die Funktion im Wartezustand ist, können neue <a href="../misc/Threads.htm">Threads</a> via <a href="../Hotkeys.htm">Hotkeys</a>, <a href="Menu.htm">benutzerdefinierte Menüpunkte</a> oder <a href="SetTimer.htm">Timer</a> gestartet werden.</p>
  </dd>

</dl>

<h2 id="Error_Handling">Fehlerbehandlung</h2>
<p>Es wird ein <a href="Error.htm#TargetError">TargetError</a> ausgelöst, wenn das Fenster nicht gefunden werden konnte, es sei denn, der <a href="#group">Gruppenmodus</a> wird verwendet.</p>
<p>Es wird keine Ausnahme ausgelöst, wenn ein Fenster gefunden wird, aber nicht geschlossen werden kann. Verwenden Sie daher <a href="WinExist.htm">WinExist</a> oder <a href="WinWaitClose.htm">WinWaitClose</a>, um ein eindeutiges Schließen eines Fensters festzustellen.</p>

<h2 id="Remarks">Bemerkungen</h2>
<p>Diese Funktion sendet eine Close-Meldung an das Fenster. Das Ergebnis hängt vom Fenster ab (es könnte fragen, ob Sie die Daten speichern wollen, und so weiter).</p>
<p>Wenn ein übereinstimmendes Fenster aktiv ist, wird bei mehreren übereinstimmenden Fenstern vorrangig dieses Fenster geschlossen. Im Falle mehrerer übereinstimmender Fenster wird generell das oberste (zuletzt verwendete) Fenster geschlossen.</p>
<p id="group">Diese Funktion agiert nur mit einem einzelnen Fenster, es sei denn, <em>FensterTitel</em> ist <a href="GroupAdd.htm">ahk_group GruppeName</a> (ohne Angabe anderer Kriterien), dann sind alle Fenster in der Gruppe betroffen.</p>
<p>WinClose sendet eine WM_CLOSE-Meldung an das Zielfenster, was eine etwas gewaltsame Methode zum Schließen des Fensters ist. Eine alternative Methode zum Schließen eines Fensters ist das Senden der folgenden Meldung. Beachten Sie aber, dass das Fenster sich dabei eventuell anders verhält, weil diese Methode quasi das gleiche ist wie, als würde man <kbd>Alt</kbd>+<kbd>F4</kbd> oder die Schließen-Schaltfläche in der Titelleiste drücken:</p>
<pre>PostMessage 0x0112, 0xF060,,, FensterTitel, FensterText  <em>; 0x0112 = WM_SYSCOMMAND, 0xF060 = SC_CLOSE</em></pre>
<p>Wenn ein Fenster sich nicht via WinClose schließen lässt, können Sie es mit <a href="WinKill.htm">WinKill</a> erzwingen.</p>
<p>Fenstertitel und -texte sind Groß-/Kleinschreibung-sensitiv. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>
<h2 id="Related">Siehe auch</h2>
<p><a href="WinKill.htm">WinKill</a>, <a href="WinWaitClose.htm">WinWaitClose</a>, <a href="ProcessClose.htm">ProcessClose</a>, <a href="WinActivate.htm">WinActivate</a>, <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>, <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a>, <a href="../misc/WinTitle.htm#LastFoundWindow">Zuletzt Gefundenes Fenster</a>, <a href="WinExist.htm">WinExist</a>, <a href="WinActive.htm">WinActive</a>, <a href="WinWaitActive.htm">WinWaitActive</a>, <a href="WinWait.htm">WinWait</a>, <a href="GroupActivate.htm">GroupActivate</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Wenn Notepad vorhanden ist, schließe es, andernfalls schließe den Taschenrechner.</p>
<pre>if WinExist("Unbenannt - Editor")
    WinClose <em>; Verwendet das von WinExist gefundene Fenster.</em>
else
    WinClose "Rechner"</pre>
</div>

</body>
</html>
