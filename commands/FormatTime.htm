<!DOCTYPE HTML>
<html lang="de">
<head>
<title>FormatTime - Syntax &amp; Verwendung | AutoHotkey v2</title>
<meta name="description" content="Die FormatTime-Funktion transformiert einen YYYYMMDDHH24MISS-Zeitstempel in ein bestimmtes Datum/Zeit-Format." />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/ga4.js" type="text/javascript"></script>
<style type="text/css">
.red {color: #FF0000}
</style>
</head>
<body>

<h1>FormatTime</h1>

<p>Transformiert einen <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Zeitstempel in ein bestimmtes Datum/Zeit-Format.</p>

<pre class="Syntax">Zkette := <span class="func">FormatTime</span>(<span class="optional"><a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>, Format</span>)</pre>
<h2 id="Parameters">Parameter</h2>
<dl>

  <dt>YYYYMMDD...</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Lassen Sie diesen Parameter leer, um das heutige Datum und die aktuelle Uhrzeit zu verwenden. Ansonsten können Sie den kompletten oder beginnenden Teil eines Zeitstempels im <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Format angeben.</p>
  </dd>

  <dt>Format</dt>
  <dd>
    <p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
    <p>Lässt man diesen Parameter weg, wird standardmäßig die Uhrzeit gefolgt vom langen Datum verwendet, die beide gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers formatiert werden. Zum Beispiel: 10:24 Freitag, 30. April 2010</p>
    <p>Ansonsten können Sie ein oder mehrere Datum-Zeit-Formate aus den unteren Tabellen angeben und direkt geschriebene Leer- und Satzzeichen dazwischen einfügen (Kommas müssen nicht mit einem Escapezeichen versehen werden; sie können normal verwendet werden). Beachten Sie im folgenden Beispiel, dass das M großgeschrieben werden muss: d.M.yyyy h:mm:tt</p>
  </dd>

</dl>

<h2 id="Return_Value">Rückgabewert</h2>
<p>Typ: <a href="../Concepts.htm#strings">Zeichenkette</a></p>
<p>Diese Funktion gibt die transformierte Version des angegebenen Zeitstempels zurück.</p>
<p>Enthält <em>YYYYMMDDHH24MISS</em> einen ungültigen Datums- und/oder Zeitbereich (z. B. der 29. Februar eines Nicht-Schaltjahrs), wird der entsprechende Bereich im Rückgabewert weggelassen. Trotz der Tatsache, dass nur Jahre zwischen 1601 und 9999 unterstützt werden, können formatierte Zeiten vor 1601 erzeugt werden, solange der Zeitbereich gültig ist.</p>
<p>Enthält <em>Format</em> mehr als 2000 Zeichen, wird eine leere Zeichenkette zurückgegeben.</p>

<h2 id="Date_Formats">Datumsformate (Groß-/Kleinschreibung-sensitiv)</h2>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="Beschr">Beschreibung</th>
  </tr>
  <tr>
    <td>d</td>
    <td>Tag des Monats ohne Null am Anfang (1 – 31)</td>
  </tr>
  <tr>
    <td>dd</td>
    <td>Tag des Monats mit einer Null am Anfang (01 – 31)</td>
  </tr>
  <tr>
    <td>ddd</td>
    <td>Kurzschreibweise des Wochentags (z. B. Mo) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>dddd</td>
    <td>Vollständiger Name des Wochentags (z. B. Montag) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>M</td>
    <td>Monat ohne Null am Anfang (1 – 12)</td>
  </tr>
  <tr>
    <td>MM</td>
    <td>Monat mit einer Null am Anfang (01 – 12)</td>
  </tr>
  <tr>
    <td>MMM</td>
    <td>Kurzschreibweise des Monats (z. B. Jan) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>MMMM</td>
    <td>Vollständiger Name des Monats (z. B. Januar) in der Sprache des aktuellen Benutzers</td>
  </tr>
  <tr>
    <td>y</td>
    <td>Jahr ohne Jahrhundert, ohne Null am Anfang (0 – 99)</td>
  </tr>
  <tr>
    <td>yy</td>
    <td>Jahr ohne Jahrhundert, mit einer Null am Anfang (00 – 99)</td>
  </tr>
  <tr>
    <td>yyyy</td>
    <td>Jahr mit Jahrhundert. Zum Beispiel: 2005</td>
  </tr>
  <tr>
    <td>gg</td>
    <td>Zeitrechnung/Ära gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers (z. B. n. Chr.)</td>
  </tr>
</table>
<h2 id="Time_Formats">Zeitformate (Groß-/Kleinschreibung-sensitiv)</h2>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="Beschr">Beschreibung</th>
  </tr>
  <tr>
    <td>h</td>
    <td>Stunde ohne Null am Anfang; 12-Stunden-Format (1 – 12)</td>
  </tr>
  <tr>
    <td>hh</td>
    <td>Stunde mit einer Null am Anfang; 12-Stunden-Format (01 – 12)</td>
  </tr>
  <tr>
    <td>H</td>
    <td>Stunde ohne Null am Anfang; 24-Stunden-Format (0 – 23)</td>
  </tr>
  <tr>
    <td>HH</td>
    <td>Stunde mit einer Null am Anfang; 24-Stunden-Format (00 – 23)</td>
  </tr>
  <tr>
    <td>m</td>
    <td>Minute ohne Null am Anfang (0 – 59)</td>
  </tr>
  <tr>
    <td>mm</td>
    <td>Minute mit einer Null am Anfang (00 – 59)</td>
  </tr>
  <tr>
    <td>s</td>
    <td>Sekunde ohne Null am Anfang (0 – 59)</td>
  </tr>
  <tr>
    <td>ss</td>
    <td>Sekunde mit einer Null am Anfang (00 – 59)</td>
  </tr>
  <tr>
    <td>t</td>
    <td>Einzelzeichen-Zeitmarker wie A oder P (gemäß den aktuellen Sprach- und Regionseinstellungen)</td>
  </tr>
  <tr>
    <td>tt</td>
    <td>Mehrfachzeichen-Zeitmarker wie AM oder PM (gemäß den aktuellen Sprach- und Regionseinstellungen)</td>
  </tr>
</table>
<h2 id="Standalone_Formats">Alleinstehende Formate</h2>
  <p>Die folgenden Formate sind <strong>alleinstehend</strong>; das heißt, dass keine anderen Formate oder Texte im <em>Format</em>-Parameter angegeben werden dürfen. Diese Formate sind nicht Groß-/Kleinschreibung-sensitiv.</p>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="Beschr">Beschreibung</th>
  </tr>
  <tr>
    <td>(Leer)</td>
    <td>Lassen Sie <em>Format</em> leer, um die Zeit gefolgt vom langen Datum zu erzeugen. Zum Beispiel: 10:24 Freitag, 30. April 2010</td>
  </tr>
  <tr>
    <td>Time</td>
    <td>Die Uhrzeit gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers, z. B. 12:04</td>
  </tr>
  <tr>
    <td>ShortDate</td>
    <td>Das kurze Datum gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers, z. B. 30.04.2010</td>
  </tr>
  <tr>
    <td>LongDate</td>
    <td>Das lange Datum gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers, z. B. Freitag, 30. April 2010</td>
  </tr>
  <tr>
    <td>YearMonth</td>
    <td>Monat und Jahr gemäß den aktuellen Sprach- und Regionseinstellungen des Benutzers, z. B. April 2010</td>
  </tr>
  <tr>
    <td>YDay</td>
    <td>Tag des Jahres ohne Nullen am Anfang (1 - 366)</td>
  </tr>
  <tr>
    <td>YDay0</td>
    <td>Tag des Jahres mit Nullen am Anfang (001 - 366)</td>
  </tr>
  <tr>
    <td>WDay</td>
    <td>Wochentag (1 - 7). Sonntag ist 1.</td>
  </tr>
  <tr>
    <td>YWeek</td>
    <td>Das vollständige Jahr und die Wochennummer gemäß ISO 8601. Zum Beispiel: 200453. Wenn die Woche mit dem 1. Januar mindestens vier Tage im neuen Jahr hat, ist sie Woche 1. Ansonsten ist sie die letzte Woche des vorherigen Jahres, und die nachfolgende Woche die erste Woche des neuen Jahres. Folglich sind sowohl der 4. Januar als auch der erste Donnerstag im Januar immer in Woche 1.</td>
  </tr>
</table>
<h2 id="Additional_Options">Zusätzliche Optionen</h2>
<p>Der <em>YYYYMMDDHH24MISS</em>-Parameter kann folgende Optionen enthalten, die direkt nach dem Zeitstempel erfolgen müssen (gibt es keinen Zeitstempel, können diese Optionen auch alleine stehen). Beachten Sie im folgenden Beispiel, dass keine Kommas zwischen den letzten vier Elementen vorhanden sind:</p>
<pre>AusgabeVar := FormatTime("20040228 LSys D1 D4")</pre>
<p><strong>R</strong>: Umkehren. Zeigt das Datum vor der Zeit an (nur sinnvoll, wenn <em>Format</em> leer ist).</p>
<p><strong>Ln</strong>: Wenn diese Option <em>nicht</em> vorhanden ist, werden die aktuellen Sprach- und Regionseinstellungen des Benutzers zum Formatieren der Zeichenkette herangezogen. Geben Sie LSys an, um stattdessen die Sprach- und Regionseinstellungen des Systems zu nutzen. Für andere Sprach- und Regionseinstellungen können Sie den Buchstaben L und direkt danach einen dezimalen oder hexadezimalen Locale-Identifikator (LCID) angeben. Informationen darüber, wie sich eine LCID zusammensetzt, finden Sie unter <a href="https://www.microsoft.com">www.microsoft.com</a> mit folgendem Suchbegriff: Locale Identifiers</p>
<p><strong>Dn</strong>: Datumsoptionen. Geben Sie für <strong>n</strong> eine der folgenden Zahlen an:</p>
<ul>
  <li>0 = Erzwingt die Verwendung der Standardoptionen. Dies führt dazu, dass das kurze Datum wirksam wird.</li>
  <li>1 = Verwendet das kurze Datum (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 2 und 8).</li>
  <li>2 = Verwendet das lange Datum (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 1 und 8).</li>
  <li>4 = Verwendet einen alternativen Kalender (falls vorhanden).</li>
  <li>8 = Verwendet das Jahr-Monat-Format (nur sinnvoll, wenn <em>Format</em> leer ist; nicht kompatibel mit 1 und 2).</li>
  <li>0x10 = Fügt Markierungen für das Links-nach-Rechts-Leselayout hinzu.</li>
  <li>0x20 = Fügt Markierungen für Rechts-nach-Links-Leselayout hinzu.</li>
  <li>0x80000000 = Bewirkt, dass alle Änderungen, die der Benutzer eventuell am Standarddatumsformat des Systems durchgeführt hat, ignoriert werden.</li>
  <li>0x40000000 = Verwendet zum Übersetzen der Zeichenkette nicht den definierten Zeichensatz in den Sprach- und Regionseinstellungen, sondern den ANSI-Zeichensatz des Systems.</li>
</ul>
<p><strong>Tn</strong>: Zeitoptionen. Geben Sie für <strong>n</strong> eine der folgenden Zahlen an:</p>
<ul>
  <li>0 = Erzwingt die Verwendung der Standardoptionen. Dies führt dazu, dass Minuten und Sekunden angezeigt werden.</li>
  <li>1 = Lässt die Minuten und Sekunden weg.</li>
  <li>2 = Lässt die Sekunden weg.</li>
  <li>4 = Lässt den Zeitmarker (z. B. AM/PM) weg.</li>
  <li>8 = Verwendet das 24-Stunden-Format anstelle des 12-Stunden-Formats.</li>
  <li>12 = Hat den kombinierten Effekt von 4 und 8.</li>
  <li>0x80000000 = Bewirkt, dass alle Änderungen, die der Benutzer eventuell am Standarduhrzeitformat des Systems durchgeführt hat, ignoriert werden.</li>
  <li>0x40000000 = Verwendet zum Übersetzen der Zeichenkette nicht den definierten Zeichensatz in den Sprach- und Regionseinstellungen, sondern den ANSI-Zeichensatz des Systems.</li>
</ul>
<p class="note"><strong>Hinweis</strong>: Dn und Tn können beliebig oft verwendet werden, um mehr als eine Option wirksam werden zu lassen, zum Beispiel: <code>FormatTime("20040228 D2 D4 T1 T8")</code></p>
<h2 id="Remarks">Bemerkungen</h2>
<p>Um Buchstaben und Zahlen in <em>Format</em> unverändert auf die finale Zeichenkette zu übertragen, umschließen Sie sie mit Hochkommas. Zum Beispiel: <code>"'Datum:' MM/dd/yy 'Zeit:' hh:mm:ss tt"</code>.</p>
<p>Nicht-alphanumerische Zeichen wie Leerzeichen, Tabulatoren, Zeilenumbruchszeichen (`n), Schrägstriche, Doppelpunkte, Kommas und sonstige Satzzeichen müssen hingegen nicht in Hochkommas gesetzt werden. Die Ausnahme ist das Hochkomma selbst: Um es darzustellen, benötigen Sie vier aufeinanderfolgende Hochkommas (''''), oder nur zwei, wenn das Hochkomma bereits von einem äußeren Paar von Hochkommas umschlossen ist.</p>
<p>Wenn <em>Format</em> sowohl Datums- als auch Zeitelemente enthält, dürfen sie nicht vermischt werden. Das heißt, dass die Elemente so angeordnet werden sollen, dass die resultierende Zeichenkette in zwei Hälften aufgeteilt werden kann: eine Zeithälfte und eine Datumhälfte. Die Formatzeichenkette "hh yyyy mm" beispielsweise würde nicht das erwartete Ergebnis liefern, weil sich ein Datumselement zwischen zwei Zeitelementen befindet.</p>
<p>Enthält <em>Format</em> einen numerischen Monatstag (d oder dd) gefolgt von einem vollständigen Monatsnamen (MMMM), wird der Genitiv des Monatsnamens verwendet (wenn die Sprache einen Genitiv besitzt).</p>
<p>Mit <a href="DateAdd.htm">DateAdd</a> und <a href="DateDiff.htm">DateDiff</a> können beliebige Datum- und Zeitwerte addiert, subtrahiert und verglichen werden.</p>
<h2 id="Related">Siehe auch</h2>
<p>Wenn Sie stattdessen den <em><em>umgekehrten</em></em> Weg gehen wollen, eine formatierte Zeichenkette in das <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Format umzuwandeln, hilft Ihnen der folgende Forumsbeitrag weiter: <a href="https://www.autohotkey.com/forum/topic20405.html">www.autohotkey.com/forum/topic20405.html</a></p>
<p>Siehe auch: <a href="GuiControls.htm#DateTime">DateTime-Steuerelement</a>, <a href="Format.htm">Format</a>, <a href="../Variables.htm#date">interne Datums- und Zeitvariablen</a>, <a href="FileGetTime.htm">FileGetTime</a></p>
<h2 id="Examples">Beispiele</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Zeigt verschiedene Verwendungsmöglichkeiten.</p>
<pre>ZeitZkette := FormatTime()
MsgBox "Uhrzeit und Datum (Zeit zuerst) ist aktuell " ZeitZkette

ZeitZkette := FormatTime("R")
MsgBox "Uhrzeit und Datum (Datum zuerst) ist aktuell " ZeitZkette

ZeitZkette := FormatTime(, "Time")
MsgBox "Uhrzeit ist aktuell " ZeitZkette

ZeitZkette := FormatTime("T12", "Time")
MsgBox "24-Stunden-Uhrzeit ist aktuell " ZeitZkette

ZeitZkette := FormatTime(, "LongDate")
MsgBox "Datum (Langformat) ist aktuell " ZeitZkette

ZeitZkette := FormatTime(20050423220133, "dddd MMMM d, yyyy hh:mm:ss tt")
MsgBox "Datum und Uhrzeit ist nach dem Formatieren " ZeitZkette

MsgBox FormatTime(200504, "'Monatsname': MMMM`n'Tagesname': dddd")

JahrWoche := FormatTime(20050101, "YWeek")
MsgBox "Der 1. Januar 2005 hat das folgende Jahr und die Wochennummer nach ISO: " JahrWoche</pre>
</div>

<div class="ex" id="ExFileTime">
<p><a class="ex_number" href="#ExFileTime"></a> Ändert den Zeitstempel einer Datei.</p>
<pre>DateiName := FileSelect(3,, "Datei auswählen")
if DateiName = "" <em>; Der Benutzer hat keine Datei ausgewählt.</em>
    return
DateiZeit := FileGetTime(DateiName)
DateiZeit := FormatTime(DateiZeit)   <em>; Durch Weglassen des letzten Parameters wird die Uhrzeit und das lange Datum abgerufen.</em>
MsgBox "Die ausgewählte Datei wurde zuletzt am " DateiZeit " modifiziert."</pre>
</div>

<div class="ex" id="ExFormatSec">
<p><a class="ex_number" href="#ExFormatSec"></a> Wandelt eine bestimmte Anzahl von Sekunden in Stunden, Minuten und Sekunden um (hh:mm:ss-Format).</p>
<pre>MsgBox FormatiereSekunden(7384)  <em>; 7384 = 2 Stunden + 3 Minuten + 4 Sekunden. Rückgabewert: 2:03:04</em>

FormatiereSekunden(SekundenAnzahl)  <em>; Wandelt eine bestimmte Zahl in das hh:mm:ss-Format um.</em>
{
    Zeit := 19990101  <em>; *Mitternacht* eines beliebigen Datums.</em>
    Zeit := DateAdd(Zeit, SekundenAnzahl, "Seconds")
    return SekundenAnzahl//3600 ":" FormatTime(Zeit, "mm:ss")
    <em>/*
    ; Im Gegensatz zur oberen Methode würde die folgende nicht mehr als 24 Stunden im Wert von Sekunden unterstützen:
    return FormatTime(Zeit, "h:mm:ss")
    */</em>
}</pre>
</div>

</body>
</html>
